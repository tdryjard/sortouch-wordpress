{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Questionchat from'../questionBlock/QuestionChat';import FormContact from'../fromContact/FormContact';import cross from'./cross.png';import logo from'./logo.png';import reload from'./reload.png';import'./FormContact.css';import'./ChatBotArea.css';var ChatBotArea=function ChatBotArea(_ref){var modelId=_ref.modelId,userId=_ref.userId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),containers=_useState2[0],setContainers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),cardsQuest=_useState4[0],setCardsQuest=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cardsRes=_useState6[0],setCardsRes=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cardsCategory=_useState8[0],setCardsCategory=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),responseSelect=_useState10[0],setResponseSelect=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),storageContainers=_useState12[0],setStorageContainers=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),responseSelected=_useState14[0],setResponseSelected=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),pair=_useState16[0],setPair=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),cardsQuestFilter=_useState18[0],setCardsQuestFilter=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),chatActive=_useState20[0],setChatActive=_useState20[1];var _useState21=useState(true),_useState22=_slicedToArray(_useState21,2),textIcon=_useState22[0],setTextIcon=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),phone=_useState24[0],setPhone=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),email=_useState26[0],setEmail=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),message=_useState28[0],setMessage=_useState28[1];function validateEmail(email){var re=/^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;return re.test(email);}var validatePhone=function validatePhone(phone){var re=/^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/im;return re.test(phone);};var takePhone=function takePhone(event){setPhone(event.target.value);};var takeEmail=function takeEmail(event){setEmail(event.target.value);};var sendMail=function sendMail(){if(!validateEmail(email)){alert('email non valide');}else if(!validatePhone(phone)){alert('numéro de téléphone non valide');}else{fetch('http://192.168.43.193:8000/api/mail/create',{method:'POST',headers:{'Content-Type':'application/json','Acces-Control-Allow-Origin':{origin:origin}},body:JSON.stringify({phone:phone,email:email,message:message,category_id:categoryId,model_id:modelId,user_id:userId,view:0})});}};var getMessage=function getMessage(e){setMessage(e.target.value);};useEffect(function(){printContainers();},[userId,responseSelected]);useEffect(function(){setTimeout(function(){setTextIcon(false);},6000);},[]);var printContainers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:try{fetch(\"http://192.168.43.193:8000/api/container/findAll/\".concat(userId,\"/\").concat(responseSelect,\"/\").concat(modelId)).then(function(res){return res.json();}).then(function(res){if(res.length){if(storageContainers){var resResult=res.filter(function(res){return res.response_id!=null;});var newContainer=[].concat(_toConsumableArray(storageContainers),_toConsumableArray(resResult));setContainers(newContainer);takeCard(newContainer);}else{setContainers(res);takeCard(res);}}});}catch(error){console.log(error);}setStorageContainers(containers);case 2:case\"end\":return _context.stop();}}},_callee);}));return function printContainers(){return _ref2.apply(this,arguments);};}();var takeCard=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){var stock,i,resulted,result,stockFilter,stockRes,_i,_resulted,_result,stockCategory,_i2,_resulted2,_result2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:stock=[];i=0;case 2:if(!(i<res.length+3)){_context2.next=14;break;}if(!res[i]){_context2.next=11;break;}_context2.next=6;return fetch(\"http://192.168.43.193:8000/api/relation/findCardQuestion/\".concat(res[i].id,\"/\").concat(userId,\"/\").concat(modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 6:resulted=_context2.sent;_context2.next=9;return resulted.json();case 9:result=_context2.sent;stock=[].concat(_toConsumableArray(stock),[result]);case 11:i++;_context2.next=2;break;case 14:if(!stock.length){_context2.next=20;break;}setCardsQuest(stock);_context2.next=18;return stock.filter(function(quest){return quest[0];});case 18:stockFilter=_context2.sent;setCardsQuestFilter(stockFilter);case 20:stockRes=[];_i=0;case 22:if(!(_i<res.length+3)){_context2.next=34;break;}if(!res[_i]){_context2.next=31;break;}_context2.next=26;return fetch(\"http://192.168.43.193:8000/api/relation/findCardResponse/\".concat(res[_i].id,\"/\").concat(userId,\"/\").concat(modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 26:_resulted=_context2.sent;_context2.next=29;return _resulted.json();case 29:_result=_context2.sent;stockRes=[].concat(_toConsumableArray(stockRes),[_result]);case 31:_i++;_context2.next=22;break;case 34:setCardsRes(stockRes);stockCategory=[];_i2=0;case 37:if(!(_i2<res.length+3)){_context2.next=49;break;}if(!(typeof res[_i2]==='object')){_context2.next=46;break;}_context2.next=41;return fetch(\"http://192.168.43.193:8000/api/relation/findCardCategory/\".concat(res[_i2].id,\"/\").concat(userId,\"/\").concat(modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 41:_resulted2=_context2.sent;_context2.next=44;return _resulted2.json();case 44:_result2=_context2.sent;stockCategory=[].concat(_toConsumableArray(stockCategory),[_result2]);case 46:_i2++;_context2.next=37;break;case 49:setCardsCategory(stockCategory);case 50:case\"end\":return _context2.stop();}}},_callee2);}));return function takeCard(_x){return _ref3.apply(this,arguments);};}();var selectResponse=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(cardId,index){var stockContainers,numberCard,containerIndex,stockResponseSelected,a,b,c,nbRes,i,_a;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setPair(!pair);stockContainers=containers;numberCard=cardId;containerIndex=index+1;setResponseSelect(numberCard);responseSelected.length=cardId;stockContainers.length=containerIndex;stockResponseSelected=[].concat(_toConsumableArray(responseSelected),[numberCard]);for(a=0;a<cardsRes.length;a++){if(cardsRes[a].length){for(b=0;b<cardsRes[a].length;b++){for(c=0;c<stockResponseSelected.length;c++){nbRes=cardsRes[a].filter(function(card){return stockResponseSelected.includes(card.id);});if(nbRes.length>1){for(i=0;i<stockResponseSelected.length;i++){for(_a=0;_a<nbRes.length-1;_a++){if(nbRes[_a].id===stockResponseSelected[i]){stockResponseSelected.splice(i,1);}}}}}}}}setResponseSelected(stockResponseSelected);setStorageContainers(stockContainers);if(stockContainers){printContainers();}case 12:case\"end\":return _context3.stop();}}},_callee3);}));return function selectResponse(_x2,_x3){return _ref4.apply(this,arguments);};}();var activeChat=function activeChat(){setChatActive(true);};var reloadFunction=function reloadFunction(){setContainers([]);setCardsQuest([]);setCardsRes([]);setCardsCategory([]);setResponseSelect(0);setStorageContainers();setResponseSelected([]);setCardsQuestFilter([]);};return/*#__PURE__*/React.createElement(\"div\",{className:!chatActive?\"containerIconChat\":\"containerChatbot\"},chatActive&&/*#__PURE__*/React.createElement(\"div\",{className:\"headChatbot\"},/*#__PURE__*/React.createElement(\"img\",{onClick:function onClick(){setChatActive(!chatActive);},alt:\"close sortouch\",src:cross,className:\"crossChatbot\"}),/*#__PURE__*/React.createElement(\"img\",{onClick:reloadFunction,alt:\"reload sortouch\",src:reload,className:\"reloadChatbot\"}),/*#__PURE__*/React.createElement(\"a\",{target:\"__blank\",href:\"https://sortouch.com\",className:\"sortouch\"},\"Sortouch\")),/*#__PURE__*/React.createElement(\"div\",{className:chatActive?\"contentChatbot\":\"contentIcon\"},!chatActive?/*#__PURE__*/React.createElement(\"div\",{className:\"contentIcon\"},textIcon&&/*#__PURE__*/React.createElement(\"div\",{className:\"contentTextIconChat\"},/*#__PURE__*/React.createElement(\"p\",{onClick:activeChat,className:\"textIconCard\"},/*#__PURE__*/React.createElement(Questionchat,{text:\"Prenez contact avec moi !\"}))),/*#__PURE__*/React.createElement(\"img\",{alt:\"icon chat\",onClick:activeChat,src:logo,className:\"iconChat\"})):Array.isArray(containers)&&containers.map(function(container,index){return/*#__PURE__*/React.createElement(\"div\",{className:container.content_type===\"question\"?\"contentLittleQuestChat\":container.content_type===\"response\"?\"contentResponseChat\":\"contentLittleDestinationChat\"},Array.isArray(cardsQuest[index])&&container.content_type===\"question\"&&cardsQuest[index].map(function(card){return cardsQuestFilter[cardsQuestFilter.length-1]&&card.id===cardsQuestFilter[cardsQuestFilter.length-1][0].id?/*#__PURE__*/React.createElement(\"div\",{className:\"contentQuestChat\"},/*#__PURE__*/React.createElement(Questionchat,{text:card.content}),/*#__PURE__*/React.createElement(\"img\",{alt:\"sortouch\",src:logo,className:\"logoChat\"})):/*#__PURE__*/React.createElement(\"div\",{className:\"contentQuestChat\"},/*#__PURE__*/React.createElement(\"p\",{className:\"textQuest\"},card.content),/*#__PURE__*/React.createElement(\"img\",{alt:\"sortouch\",src:logo,className:\"logoChat\"}));}),Array.isArray(cardsRes[index])&&container.content_type===\"response\"&&cardsRes[index].map(function(card){return/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){selectResponse(card.id,index);},className:responseSelected.includes(card.id)?'containerLittleCardResChatActive':'containerLittleCardResChat'},/*#__PURE__*/React.createElement(\"p\",{id:\"container\".concat(index),className:\"textCardResChat\"},card.content));}),Array.isArray(cardsCategory[index])&&container.content_type===\"category\"&&cardsCategory[index].map(function(card){return/*#__PURE__*/React.createElement(\"div\",{className:\"containerLittleFormChatbot\"},/*#__PURE__*/React.createElement(\"input\",{onChange:takeEmail,type:\"text\",className:\"inputFormChat\",placeholder:\"email\"}),/*#__PURE__*/React.createElement(\"input\",{onChange:takePhone,type:\"text\",className:\"inputFormChat\",placeholder:\"num\\xE9ro de t\\xE9l\\xE9phone\"}),/*#__PURE__*/React.createElement(\"textarea\",{className:\"inputMessageFormChatbot\",placeholder:\"message\",onChange:getMessage}),/*#__PURE__*/React.createElement(\"div\",{onClick:sendMail,className:\"sendFormChatbot\"},\"Envoyer !\"));}));})));};export default ChatBotArea;","map":{"version":3,"sources":["/var/www/html/wp-content/plugins/sortouch/sortouch/src/chatbotArea/ChatBotArea.js"],"names":["React","useState","useEffect","Questionchat","FormContact","cross","logo","reload","ChatBotArea","modelId","userId","containers","setContainers","cardsQuest","setCardsQuest","cardsRes","setCardsRes","cardsCategory","setCardsCategory","responseSelect","setResponseSelect","storageContainers","setStorageContainers","responseSelected","setResponseSelected","pair","setPair","cardsQuestFilter","setCardsQuestFilter","chatActive","setChatActive","textIcon","setTextIcon","phone","setPhone","email","setEmail","message","setMessage","validateEmail","re","test","validatePhone","takePhone","event","target","value","takeEmail","sendMail","alert","fetch","method","headers","origin","body","JSON","stringify","category_id","categoryId","model_id","user_id","view","getMessage","e","printContainers","setTimeout","then","res","json","length","resResult","filter","response_id","newContainer","takeCard","error","console","log","stock","i","id","resulted","result","quest","stockFilter","stockRes","stockCategory","selectResponse","cardId","index","stockContainers","numberCard","containerIndex","stockResponseSelected","a","b","c","nbRes","card","includes","splice","activeChat","reloadFunction","Array","isArray","map","container","content_type","content"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Questionchat from '../questionBlock/QuestionChat';\nimport FormContact from '../fromContact/FormContact';\nimport cross from './cross.png'\nimport logo from './logo.png'\nimport reload from './reload.png'\nimport './FormContact.css'\nimport './ChatBotArea.css'\n\nconst ChatBotArea = ({ modelId, userId }) => {\n    const [containers, setContainers] = useState([])\n    const [cardsQuest, setCardsQuest] = useState([])\n    const [cardsRes, setCardsRes] = useState([])\n    const [cardsCategory, setCardsCategory] = useState([])\n    const [responseSelect, setResponseSelect] = useState(0)\n    const [storageContainers, setStorageContainers] = useState()\n    const [responseSelected, setResponseSelected] = useState([])\n    const [pair, setPair] = useState(false)\n    const [cardsQuestFilter, setCardsQuestFilter] = useState([])\n    const [chatActive, setChatActive] = useState(false)\n    const [textIcon, setTextIcon] = useState(true)\n    const [phone, setPhone] = useState(\"\")\n    const [email, setEmail] = useState(\"\")\n    const [message, setMessage] = useState(\"\")\n\n    function validateEmail(email) {\n        let re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return re.test(email);\n    }\n\n    const validatePhone = (phone) => {\n        let re = /^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/im\n        return re.test(phone)\n    }\n\n    const takePhone = (event) => {\n        setPhone(event.target.value)\n    }\n\n    const takeEmail = (event) => {\n        setEmail(event.target.value)\n    }\n\n    const sendMail = () => {\n        if(!validateEmail(email)){\n            alert('email non valide')\n        } else if (!validatePhone(phone)){\n            alert('numéro de téléphone non valide')\n        } else {\n            fetch('http://192.168.43.193:8000/api/mail/create', {\n                method: 'POST',\n                headers: {\n                    'Content-Type' :'application/json',\n                    'Acces-Control-Allow-Origin' : {origin}\n                },\n                body: JSON.stringify({\n                    phone : phone,\n                    email : email,\n                    message: message,\n                    category_id : categoryId,\n                    model_id : modelId,\n                    user_id : userId,\n                    view: 0\n                    })\n                });\n        }\n    }\n\n    const getMessage = (e) => {\n        setMessage(e.target.value)\n    }\n\n    useEffect(() => {\n        printContainers()\n    }, [userId, responseSelected])\n\n    useEffect(() => {\n        setTimeout(() => {\n            setTextIcon(false)\n        }, 6000)\n    }, [])\n\n\n    const printContainers = async () => {\n        try {\n            fetch(`http://192.168.43.193:8000/api/container/findAll/${userId}/${responseSelect}/${modelId}`)\n                .then(res => res.json())\n                .then(res => {\n                    if (res.length) {\n                        if (storageContainers) {\n                            let resResult = res.filter(res => res.response_id != null)\n                            let newContainer = [...storageContainers, ...resResult]\n                            setContainers(newContainer)\n                            takeCard(newContainer)\n                        } else {\n                            setContainers(res)\n                            takeCard(res)\n                        }\n                    }\n                })\n\n\n        } catch (error) {\n            console.log(error)\n        }\n        setStorageContainers(containers)\n    }\n\n    const takeCard = async (res) => {\n        let stock = []\n        for (let i = 0; i < res.length + 3; i++) {\n            if (res[i]) {\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardQuestion/${res[i].id}/${userId}/${modelId}`, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stock = [...stock, result]\n            }\n        }\n        if (stock.length) {\n\n            setCardsQuest(stock)\n            const stockFilter = await stock.filter(quest => quest[0])\n            setCardsQuestFilter(stockFilter)\n\n        }\n\n\n        let stockRes = []\n        for (let i = 0; i < res.length + 3; i++) {\n            if (res[i]) {\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardResponse/${res[i].id}/${userId}/${modelId}`, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stockRes = [...stockRes, result]\n            }\n        }\n        setCardsRes(stockRes)\n        let stockCategory = []\n        for (let i = 0; i < res.length + 3; i++) {\n            if (typeof res[i] === 'object') {\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardCategory/${res[i].id}/${userId}/${modelId}`, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stockCategory = [...stockCategory, result]\n            }\n        }\n        setCardsCategory(stockCategory)\n    }\n\n    const selectResponse = async function (cardId, index) {\n        setPair(!pair)\n        const stockContainers = containers\n        const numberCard = cardId\n        const containerIndex = index + 1\n        setResponseSelect(numberCard)\n\n\n\n        responseSelected.length = cardId\n        stockContainers.length = containerIndex\n\n\n        let stockResponseSelected = ([...responseSelected, numberCard])\n\n        for (let a = 0; a < cardsRes.length; a++) {\n            if (cardsRes[a].length) {\n                for (let b = 0; b < cardsRes[a].length; b++) {\n                    for (let c = 0; c < stockResponseSelected.length; c++) {\n                        const nbRes = cardsRes[a].filter(card => stockResponseSelected.includes(card.id))\n                        if (nbRes.length > 1) {\n                            for (let i = 0; i < stockResponseSelected.length; i++) {\n                                for (let a = 0; a < nbRes.length - 1; a++) {\n                                    if (nbRes[a].id === (stockResponseSelected[i])) {\n                                        stockResponseSelected.splice(i, 1)\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        setResponseSelected(stockResponseSelected)\n\n        setStorageContainers(stockContainers)\n\n        if (stockContainers) {\n            printContainers()\n        }\n    }\n\n\n    const activeChat = () => {\n        setChatActive(true)\n    }\n\n    const reloadFunction = () => {\n        setContainers([])\n        setCardsQuest([])\n        setCardsRes([])\n        setCardsCategory([])\n        setResponseSelect(0)\n        setStorageContainers()\n        setResponseSelected([])\n        setCardsQuestFilter([])\n    }\n\n\n\n\n    return (\n        <div className={!chatActive ? \"containerIconChat\" : \"containerChatbot\"}>\n            {chatActive &&\n                <div className=\"headChatbot\">\n                    <img onClick={() => { setChatActive(!chatActive) }} alt=\"close sortouch\" src={cross} className=\"crossChatbot\" />\n                    <img onClick={reloadFunction} alt=\"reload sortouch\" src={reload} className=\"reloadChatbot\" />\n                    <a target=\"__blank\" href=\"https://sortouch.com\" className=\"sortouch\">Sortouch</a>\n                </div>}\n            <div className={chatActive ? \"contentChatbot\" : \"contentIcon\"}>\n                {!chatActive ?\n                    <div className=\"contentIcon\">\n                        {textIcon &&\n                            <div className=\"contentTextIconChat\">\n                                <p onClick={activeChat} className=\"textIconCard\"><Questionchat text={\"Prenez contact avec moi !\"} /></p>\n                            </div>}\n                        <img alt=\"icon chat\" onClick={activeChat} src={logo} className=\"iconChat\" />\n                    </div>\n                    :\n                    Array.isArray(containers) &&\n                    containers.map((container, index) => {\n                        return (\n                            <div className={container.content_type === \"question\" ? \"contentLittleQuestChat\" : container.content_type === \"response\" ? \"contentResponseChat\" : \"contentLittleDestinationChat\"}>\n                                {Array.isArray(cardsQuest[index]) && container.content_type === \"question\" &&\n                                    cardsQuest[index].map(card => {\n                                        return (\n                                            cardsQuestFilter[cardsQuestFilter.length - 1] && card.id === cardsQuestFilter[cardsQuestFilter.length - 1][0].id ?\n                                                <div className=\"contentQuestChat\">\n                                                    <Questionchat text={card.content} />\n                                                    <img alt=\"sortouch\" src={logo} className=\"logoChat\" />\n                                                </div>\n                                                :\n                                                <div className=\"contentQuestChat\">\n                                                    <p className=\"textQuest\">{card.content}</p>\n                                                    <img alt=\"sortouch\" src={logo} className=\"logoChat\" />\n                                                </div>\n                                        )\n                                    })}\n                                {Array.isArray(cardsRes[index]) && container.content_type === \"response\" &&\n                                    cardsRes[index].map(card => {\n                                        return (\n                                            <div onClick={() => { selectResponse(card.id, index) }} className={responseSelected.includes(card.id) ? 'containerLittleCardResChatActive' : 'containerLittleCardResChat'}>\n                                                <p id={`container${index}`} className=\"textCardResChat\">{card.content}</p>\n                                            </div>)\n                                    })\n                                }\n                                {Array.isArray(cardsCategory[index]) && container.content_type === \"category\" &&\n                                    cardsCategory[index].map(card => {\n                                        return (\n                                            <div className=\"containerLittleFormChatbot\">\n                                                <input onChange={takeEmail} type=\"text\" className=\"inputFormChat\" placeholder=\"email\" />\n                                                <input onChange={takePhone} type=\"text\" className=\"inputFormChat\" placeholder=\"numéro de téléphone\" />\n                                                <textarea className=\"inputMessageFormChatbot\" placeholder=\"message\" onChange={getMessage} />\n                                                <div onClick={sendMail} className=\"sendFormChatbot\">Envoyer !</div>\n                                            </div>\n                                        )\n                                    })}\n                            </div>\n                        )\n                    })}\n            </div>\n        </div>\n    )\n}\n\nexport default ChatBotArea"]},"metadata":{},"sourceType":"module"}