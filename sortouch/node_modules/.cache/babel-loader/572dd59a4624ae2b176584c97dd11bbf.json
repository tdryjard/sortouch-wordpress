{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Questionchat from'../questionBlock/QuestionChat';import FormContact from'../fromContact/FormContact';import cross from'./cross.png';import logo from'./logo.png';import reload from'./reload.png';import'./ChatBotArea.css';var ChatBotArea=function ChatBotArea(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),containers=_useState2[0],setContainers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),cardsQuest=_useState4[0],setCardsQuest=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cardsRes=_useState6[0],setCardsRes=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cardsCategory=_useState8[0],setCardsCategory=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),responseSelect=_useState10[0],setResponseSelect=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),storageContainers=_useState12[0],setStorageContainers=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),responseSelected=_useState14[0],setResponseSelected=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),pair=_useState16[0],setPair=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),cardsQuestFilter=_useState18[0],setCardsQuestFilter=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),chatActive=_useState20[0],setChatActive=_useState20[1];var _useState21=useState(true),_useState22=_slicedToArray(_useState21,2),textIcon=_useState22[0],setTextIcon=_useState22[1];useEffect(function(){printContainers();},[props.userId,responseSelected]);useEffect(function(){setTimeout(function(){setTextIcon(false);},4000);});var printContainers=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:try{fetch(\"http://192.168.43.193:8000/api/container/findAll/\".concat(props.userId,\"/\").concat(responseSelect,\"/\").concat(props.modelId)).then(function(res){return res.json();}).then(function(res){if(res.length){if(storageContainers){var resResult=res.filter(function(res){return res.response_id!=null;});var newContainer=[].concat(_toConsumableArray(storageContainers),_toConsumableArray(resResult));setContainers(newContainer);takeCard(newContainer);}else{setContainers(res);takeCard(res);}}});}catch(error){console.log(error);}setStorageContainers(containers);case 2:case\"end\":return _context.stop();}}},_callee);}));return function printContainers(){return _ref.apply(this,arguments);};}();var takeCard=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){var stock,i,resulted,result,stockFilter,stockRes,_i,_resulted,_result,stockCategory,_i2,_resulted2,_result2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:stock=[];i=0;case 2:if(!(i<res.length+3)){_context2.next=14;break;}if(!res[i]){_context2.next=11;break;}_context2.next=6;return fetch(\"http://192.168.43.193:8000/api/relation/findCardQuestion/\".concat(res[i].id,\"/\").concat(props.userId,\"/\").concat(props.modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 6:resulted=_context2.sent;_context2.next=9;return resulted.json();case 9:result=_context2.sent;stock=[].concat(_toConsumableArray(stock),[result]);case 11:i++;_context2.next=2;break;case 14:if(!stock.length){_context2.next=20;break;}setCardsQuest(stock);_context2.next=18;return stock.filter(function(quest){return quest[0];});case 18:stockFilter=_context2.sent;setCardsQuestFilter(stockFilter);case 20:stockRes=[];_i=0;case 22:if(!(_i<res.length+3)){_context2.next=34;break;}if(!res[_i]){_context2.next=31;break;}_context2.next=26;return fetch(\"http://192.168.43.193:8000/api/relation/findCardResponse/\".concat(res[_i].id,\"/\").concat(props.userId,\"/\").concat(props.modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 26:_resulted=_context2.sent;_context2.next=29;return _resulted.json();case 29:_result=_context2.sent;stockRes=[].concat(_toConsumableArray(stockRes),[_result]);case 31:_i++;_context2.next=22;break;case 34:setCardsRes(stockRes);stockCategory=[];_i2=0;case 37:if(!(_i2<res.length+3)){_context2.next=49;break;}if(!(typeof res[_i2]==='object')){_context2.next=46;break;}_context2.next=41;return fetch(\"http://192.168.43.193:8000/api/relation/findCardCategory/\".concat(res[_i2].id,\"/\").concat(props.userId,\"/\").concat(props.modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 41:_resulted2=_context2.sent;_context2.next=44;return _resulted2.json();case 44:_result2=_context2.sent;stockCategory=[].concat(_toConsumableArray(stockCategory),[_result2]);case 46:_i2++;_context2.next=37;break;case 49:setCardsCategory(stockCategory);case 50:case\"end\":return _context2.stop();}}},_callee2);}));return function takeCard(_x){return _ref2.apply(this,arguments);};}();var selectResponse=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(cardId,index){var stockContainers,numberCard,containerIndex,stockResponseSelected,a,b,c,nbRes,i,_a;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setPair(!pair);stockContainers=containers;numberCard=cardId;containerIndex=index+1;setResponseSelect(numberCard);responseSelected.length=cardId;stockContainers.length=containerIndex;stockResponseSelected=[].concat(_toConsumableArray(responseSelected),[numberCard]);for(a=0;a<cardsRes.length;a++){if(cardsRes[a].length){for(b=0;b<cardsRes[a].length;b++){for(c=0;c<stockResponseSelected.length;c++){nbRes=cardsRes[a].filter(function(card){return stockResponseSelected.includes(card.id);});if(nbRes.length>1){for(i=0;i<stockResponseSelected.length;i++){for(_a=0;_a<nbRes.length-1;_a++){if(nbRes[_a].id===stockResponseSelected[i]){stockResponseSelected.splice(i,1);}}}}}}}}setResponseSelected(stockResponseSelected);setStorageContainers(stockContainers);if(stockContainers){printContainers();}case 12:case\"end\":return _context3.stop();}}},_callee3);}));return function selectResponse(_x2,_x3){return _ref3.apply(this,arguments);};}();var activeChat=function activeChat(){setChatActive(true);};var reloadFunction=function reloadFunction(){setContainers([]);setCardsQuest([]);setCardsRes([]);setCardsCategory([]);setResponseSelect(0);setStorageContainers([]);setResponseSelected([]);setPair(false);setCardsQuestFilter([]);};return/*#__PURE__*/React.createElement(\"div\",{className:!chatActive?\"containerIconChat\":\"containerChatbot\"},chatActive&&/*#__PURE__*/React.createElement(\"div\",{className:\"headChatbot\"},/*#__PURE__*/React.createElement(\"img\",{onClick:function onClick(){setChatActive(!chatActive);},alt:\"close sortouch\",src:cross,className:\"crossChatbot\"}),/*#__PURE__*/React.createElement(\"img\",{onClick:reloadFunction,alt:\"reload sortouch\",src:reload,className:\"reloadChatbot\"}),/*#__PURE__*/React.createElement(\"a\",{target:\"__blank\",href:\"https://sortouch.com\",className:\"sortouch\"},\"Sortouch\")),/*#__PURE__*/React.createElement(\"div\",{className:chatActive?\"contentChatbot\":\"contentIcon\"},!chatActive?/*#__PURE__*/React.createElement(\"div\",{className:\"contentIcon\"},textIcon&&/*#__PURE__*/React.createElement(\"div\",{className:\"contentTextIconChat\"},/*#__PURE__*/React.createElement(\"p\",{onClick:activeChat,className:\"textIconCard\"},/*#__PURE__*/React.createElement(Questionchat,{text:\"Prenez contact avec moi !\"}))),/*#__PURE__*/React.createElement(\"img\",{alt:\"icon chat\",onClick:activeChat,src:logo,className:\"iconChat\"})):Array.isArray(containers)&&containers.map(function(container,index){return/*#__PURE__*/React.createElement(\"div\",{className:container.content_type===\"question\"?\"contentLittleQuestChat\":container.content_type===\"response\"?\"contentResponseChat\":\"contentLittleDestinationChat\"},Array.isArray(cardsQuest[index])&&container.content_type===\"question\"&&cardsQuest[index].map(function(card){return cardsQuestFilter[cardsQuestFilter.length-1]&&card.id===cardsQuestFilter[cardsQuestFilter.length-1][0].id?/*#__PURE__*/React.createElement(\"div\",{className:\"contentQuestChat\"},/*#__PURE__*/React.createElement(Questionchat,{text:card.content}),/*#__PURE__*/React.createElement(\"img\",{alt:\"sortouch\",src:logo,className:\"logoChat\"})):/*#__PURE__*/React.createElement(\"div\",{className:\"contentQuestChat\"},/*#__PURE__*/React.createElement(\"p\",{className:\"textQuest\"},card.content),/*#__PURE__*/React.createElement(\"img\",{alt:\"sortouch\",src:logo,className:\"logoChat\"}));}),Array.isArray(cardsRes[index])&&container.content_type===\"response\"&&cardsRes[index].map(function(card){return/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){selectResponse(card.id,index);},className:responseSelected.includes(card.id)?'containerLittleCardResChatActive':'containerLittleCardResChat'},/*#__PURE__*/React.createElement(\"p\",{id:\"container\".concat(index),className:\"textCardResChat\"},card.content));}),Array.isArray(cardsCategory[index])&&container.content_type===\"category\"&&cardsCategory[index].map(function(card){return/*#__PURE__*/React.createElement(FormContact,{categoryId:card.id,userId:props.userId,modelId:props.modelId});}));})));};export default ChatBotArea;","map":{"version":3,"sources":["/var/www/html/wp-content/plugins/sortouch/sortouch/src/chatbotArea/ChatBotArea.js"],"names":["React","useState","useEffect","Questionchat","FormContact","cross","logo","reload","ChatBotArea","props","containers","setContainers","cardsQuest","setCardsQuest","cardsRes","setCardsRes","cardsCategory","setCardsCategory","responseSelect","setResponseSelect","storageContainers","setStorageContainers","responseSelected","setResponseSelected","pair","setPair","cardsQuestFilter","setCardsQuestFilter","chatActive","setChatActive","textIcon","setTextIcon","printContainers","userId","setTimeout","fetch","modelId","then","res","json","length","resResult","filter","response_id","newContainer","takeCard","error","console","log","stock","i","id","method","headers","resulted","result","quest","stockFilter","stockRes","stockCategory","selectResponse","cardId","index","stockContainers","numberCard","containerIndex","stockResponseSelected","a","b","c","nbRes","card","includes","splice","activeChat","reloadFunction","Array","isArray","map","container","content_type","content"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Questionchat from '../questionBlock/QuestionChat';\nimport FormContact from '../fromContact/FormContact';\nimport cross from './cross.png'\nimport logo from './logo.png'\nimport reload from './reload.png'\nimport './ChatBotArea.css'\n\nconst ChatBotArea = (props) => {\n    const [containers, setContainers] = useState([])\n    const [cardsQuest, setCardsQuest] = useState([])\n    const [cardsRes, setCardsRes] = useState([])\n    const [cardsCategory, setCardsCategory] = useState([])\n    const [responseSelect, setResponseSelect] = useState(0)\n    const [storageContainers, setStorageContainers] = useState()\n    const [responseSelected, setResponseSelected] = useState([])\n    const [pair, setPair] = useState(false)\n    const [cardsQuestFilter, setCardsQuestFilter] = useState([])\n    const [chatActive, setChatActive] = useState(false)\n    const [textIcon, setTextIcon] = useState(true)\n\n    useEffect(() => {\n        printContainers()\n    }, [props.userId, responseSelected])\n\n    useEffect(() => {\n        setTimeout(() => {\n            setTextIcon(false)\n        }, 4000)\n    })\n\n    const printContainers = async () => {\n        try {\n            fetch(`http://192.168.43.193:8000/api/container/findAll/${props.userId}/${responseSelect}/${props.modelId}`)\n                .then(res => res.json())\n                .then(res => {\n                    if (res.length) {\n                        if (storageContainers) {\n                            let resResult = res.filter(res => res.response_id != null)\n                            let newContainer = [...storageContainers, ...resResult]\n                            setContainers(newContainer)\n                            takeCard(newContainer)\n                        } else {\n                            setContainers(res)\n                            takeCard(res)\n                        }\n                    }\n                })\n\n\n        } catch (error) {\n            console.log(error)\n        }\n        setStorageContainers(containers)\n    }\n\n    const takeCard = async (res) => {\n        let stock = []\n        for (let i = 0; i < res.length + 3; i++) {\n            if (res[i]) {\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardQuestion/${res[i].id}/${props.userId}/${props.modelId}`, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stock = [...stock, result]\n            }\n        }\n        if (stock.length) {\n\n            setCardsQuest(stock)\n            const stockFilter = await stock.filter(quest => quest[0])\n            setCardsQuestFilter(stockFilter)\n\n        }\n\n\n        let stockRes = []\n        for (let i = 0; i < res.length + 3; i++) {\n            if (res[i]) {\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardResponse/${res[i].id}/${props.userId}/${props.modelId}`, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stockRes = [...stockRes, result]\n            }\n        }\n        setCardsRes(stockRes)\n        let stockCategory = []\n        for (let i = 0; i < res.length + 3; i++) {\n            if (typeof res[i] === 'object') {\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardCategory/${res[i].id}/${props.userId}/${props.modelId}`, {\n                    method: 'GET',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stockCategory = [...stockCategory, result]\n            }\n        }\n        setCardsCategory(stockCategory)\n    }\n\n    const selectResponse = async function (cardId, index) {\n        setPair(!pair)\n        const stockContainers = containers\n        const numberCard = cardId\n        const containerIndex = index + 1\n        setResponseSelect(numberCard)\n\n\n\n        responseSelected.length = cardId\n        stockContainers.length = containerIndex\n\n\n        let stockResponseSelected = ([...responseSelected, numberCard])\n\n        for (let a = 0; a < cardsRes.length; a++) {\n            if (cardsRes[a].length) {\n                for (let b = 0; b < cardsRes[a].length; b++) {\n                    for (let c = 0; c < stockResponseSelected.length; c++) {\n                        const nbRes = cardsRes[a].filter(card => stockResponseSelected.includes(card.id))\n                        if (nbRes.length > 1) {\n                            for (let i = 0; i < stockResponseSelected.length; i++) {\n                                for (let a = 0; a < nbRes.length - 1; a++) {\n                                    if (nbRes[a].id === (stockResponseSelected[i])) {\n                                        stockResponseSelected.splice(i, 1)\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        setResponseSelected(stockResponseSelected)\n\n        setStorageContainers(stockContainers)\n\n        if (stockContainers) {\n            printContainers()\n        }\n    }\n\n\n    const activeChat = () => {\n        setChatActive(true)\n    }\n\n    const reloadFunction = () => {\n        setContainers([])\n        setCardsQuest([])\n        setCardsRes([])\n        setCardsCategory([])\n        setResponseSelect(0)\n        setStorageContainers([])\n        setResponseSelected([])\n        setPair(false)\n        setCardsQuestFilter([])\n    }\n\n\n\n\n    return (\n        <div className={!chatActive ? \"containerIconChat\" : \"containerChatbot\"}>\n            {chatActive &&\n                <div className=\"headChatbot\">\n                    <img onClick={() => { setChatActive(!chatActive) }} alt=\"close sortouch\" src={cross} className=\"crossChatbot\" />\n                    <img onClick={reloadFunction} alt=\"reload sortouch\" src={reload} className=\"reloadChatbot\" />\n                    <a target=\"__blank\" href=\"https://sortouch.com\" className=\"sortouch\">Sortouch</a>\n                </div>}\n            <div className={chatActive ? \"contentChatbot\" : \"contentIcon\"}>\n                {!chatActive ?\n                    <div className=\"contentIcon\">\n                        {textIcon &&\n                            <div className=\"contentTextIconChat\">\n                                <p onClick={activeChat} className=\"textIconCard\"><Questionchat text={\"Prenez contact avec moi !\"} /></p>\n                            </div>}\n                        <img alt=\"icon chat\" onClick={activeChat} src={logo} className=\"iconChat\" />\n                    </div>\n                    :\n                    Array.isArray(containers) &&\n                    containers.map((container, index) => {\n                        return (\n                            <div className={container.content_type === \"question\" ? \"contentLittleQuestChat\" : container.content_type === \"response\" ? \"contentResponseChat\" : \"contentLittleDestinationChat\"}>\n                                {Array.isArray(cardsQuest[index]) && container.content_type === \"question\" &&\n                                    cardsQuest[index].map(card => {\n                                        return (\n                                            cardsQuestFilter[cardsQuestFilter.length - 1] && card.id === cardsQuestFilter[cardsQuestFilter.length - 1][0].id ?\n                                                <div className=\"contentQuestChat\">\n                                                    <Questionchat text={card.content} />\n                                                    <img alt=\"sortouch\" src={logo} className=\"logoChat\" />\n                                                </div>\n                                                :\n                                                <div className=\"contentQuestChat\">\n                                                    <p className=\"textQuest\">{card.content}</p>\n                                                    <img alt=\"sortouch\" src={logo} className=\"logoChat\" />\n                                                </div>\n                                        )\n                                    })}\n                                {Array.isArray(cardsRes[index]) && container.content_type === \"response\" &&\n                                    cardsRes[index].map(card => {\n                                        return (\n                                            <div onClick={() => { selectResponse(card.id, index) }} className={responseSelected.includes(card.id) ? 'containerLittleCardResChatActive' : 'containerLittleCardResChat'}>\n                                                <p id={`container${index}`} className=\"textCardResChat\">{card.content}</p>\n                                            </div>)\n                                    })\n                                }\n                                {Array.isArray(cardsCategory[index]) && container.content_type === \"category\" &&\n                                    cardsCategory[index].map(card => {\n                                        return (\n                                            <FormContact categoryId={card.id} userId={props.userId} modelId={props.modelId} />\n                                        )\n                                    })}\n                            </div>\n                        )\n                    })}\n            </div>\n        </div>\n    )\n}\n\nexport default ChatBotArea"]},"metadata":{},"sourceType":"module"}