{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/var/www/html/wp-content/plugins/sortouch/sortouch/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Questionchat from'../questionBlock/QuestionChat';import FormContact from'../fromContact/FormContact';import cross from'./cross.png';import logo from'./logo.png';import'./ChatBotArea.css';var ChatBotArea=function ChatBotArea(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),containers=_useState2[0],setContainers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),cardsQuest=_useState4[0],setCardsQuest=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cardsRes=_useState6[0],setCardsRes=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cardsCategory=_useState8[0],setCardsCategory=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),responseSelect=_useState10[0],setResponseSelect=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),storageContainers=_useState12[0],setStorageContainers=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),responseSelected=_useState14[0],setResponseSelected=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),pair=_useState16[0],setPair=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),cardsQuestFilter=_useState18[0],setCardsQuestFilter=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),chatActive=_useState20[0],setChatActive=_useState20[1];var _useState21=useState(true),_useState22=_slicedToArray(_useState21,2),textIcon=_useState22[0],setTextIcon=_useState22[1];useEffect(function(){printContainers();},[userId,responseSelected]);useEffect(function(){setTimeout(function(){setTextIcon(false);},4000);});var printContainers=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:try{fetch(\"http://192.168.43.193:8000/api/container/findAll/\".concat(props.userId,\"/\").concat(responseSelect,\"/\").concat(props.modelId)).then(function(res){return res.json();}).then(function(res){if(res.length){if(storageContainers){var resResult=res.filter(function(res){return res.response_id!=null;});var newContainer=[].concat(_toConsumableArray(storageContainers),_toConsumableArray(resResult));setContainers(newContainer);takeCard(newContainer);}else{setContainers(res);takeCard(res);}}});}catch(error){console.log(error);}setStorageContainers(containers);case 2:case\"end\":return _context.stop();}}},_callee);}));return function printContainers(){return _ref.apply(this,arguments);};}();var takeCard=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){var stock,i,resulted,result,stockFilter,stockRes,_i,_resulted,_result,stockCategory,_i2,_resulted2,_result2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:stock=[];i=0;case 2:if(!(i<res.length+3)){_context2.next=14;break;}if(!res[i]){_context2.next=11;break;}_context2.next=6;return fetch(\"http://192.168.43.193:8000/api/relation/findCardQuestion/\".concat(res[i].id,\"/\").concat(props.userId,\"/\").concat(props.modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 6:resulted=_context2.sent;_context2.next=9;return resulted.json();case 9:result=_context2.sent;stock=[].concat(_toConsumableArray(stock),[result]);case 11:i++;_context2.next=2;break;case 14:if(!stock.length){_context2.next=20;break;}setCardsQuest(stock);_context2.next=18;return stock.filter(function(quest){return quest[0];});case 18:stockFilter=_context2.sent;setCardsQuestFilter(stockFilter);case 20:stockRes=[];_i=0;case 22:if(!(_i<res.length+3)){_context2.next=34;break;}if(!res[_i]){_context2.next=31;break;}_context2.next=26;return fetch(\"http://192.168.43.193:8000/api/relation/findCardResponse/\".concat(res[_i].id,\"/\").concat(props.userId,\"/\").concat(props.modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 26:_resulted=_context2.sent;_context2.next=29;return _resulted.json();case 29:_result=_context2.sent;stockRes=[].concat(_toConsumableArray(stockRes),[_result]);case 31:_i++;_context2.next=22;break;case 34:setCardsRes(stockRes);stockCategory=[];_i2=0;case 37:if(!(_i2<res.length+3)){_context2.next=49;break;}if(!(typeof res[_i2]==='object')){_context2.next=46;break;}_context2.next=41;return fetch(\"http://192.168.43.193:8000/api/relation/findCardCategory/\".concat(res[_i2].id,\"/\").concat(props.userId,\"/\").concat(props.modelId),{method:'GET',headers:{'Content-Type':'application/json'}});case 41:_resulted2=_context2.sent;_context2.next=44;return _resulted2.json();case 44:_result2=_context2.sent;stockCategory=[].concat(_toConsumableArray(stockCategory),[_result2]);case 46:_i2++;_context2.next=37;break;case 49:setCardsCategory(stockCategory);case 50:case\"end\":return _context2.stop();}}},_callee2);}));return function takeCard(_x){return _ref2.apply(this,arguments);};}();var selectResponse=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(cardId,index){var stockContainers,numberCard,containerIndex,stockResponseSelected,a,b,c,nbRes,i,_a;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setPair(!pair);stockContainers=containers;numberCard=cardId;containerIndex=index+1;setResponseSelect(numberCard);responseSelected.length=cardId;stockContainers.length=containerIndex;stockResponseSelected=[].concat(_toConsumableArray(responseSelected),[numberCard]);for(a=0;a<cardsRes.length;a++){if(cardsRes[a].length){for(b=0;b<cardsRes[a].length;b++){for(c=0;c<stockResponseSelected.length;c++){nbRes=cardsRes[a].filter(function(card){return stockResponseSelected.includes(card.id);});if(nbRes.length>1){for(i=0;i<stockResponseSelected.length;i++){for(_a=0;_a<nbRes.length-1;_a++){if(nbRes[_a].id===stockResponseSelected[i]){stockResponseSelected.splice(i,1);}}}}}}}}setResponseSelected(stockResponseSelected);setStorageContainers(stockContainers);if(stockContainers){printContainers();}setTimeout(function(){window.scrollTo(0,document.body.scrollHeight);},700);case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function selectResponse(_x2,_x3){return _ref3.apply(this,arguments);};}();var activeChat=function activeChat(){setChatActive(true);};return/*#__PURE__*/React.createElement(\"div\",{className:!chatActive?\"containerIconChat\":\"containerChatbot\"},chatActive&&/*#__PURE__*/React.createElement(\"div\",{className:\"headChatbot\"},/*#__PURE__*/React.createElement(\"img\",{onClick:function onClick(){setChatActive(!chatActive);},alt:\"close sortouch\",src:cross,className:\"crossChatbot\"}),/*#__PURE__*/React.createElement(\"a\",{target:\"__blank\",href:\"https://sortouch.com\",className:\"sortouch\"},\"Sortouch\")),/*#__PURE__*/React.createElement(\"div\",{className:chatActive?\"contentChatbot\":\"contentIcon\"},!chatActive?/*#__PURE__*/React.createElement(\"div\",{className:\"contentIcon\"},textIcon&&/*#__PURE__*/React.createElement(\"div\",{className:\"contentTextIconChat\"},/*#__PURE__*/React.createElement(\"p\",{onClick:activeChat,className:\"textIconCard\"},/*#__PURE__*/React.createElement(Questionchat,{text:\"Prenez contact avec moi !\"}))),/*#__PURE__*/React.createElement(\"img\",{alt:\"icon chat\",onClick:activeChat,src:logo,className:\"iconChat\"})):Array.isArray(containers)&&containers.map(function(container,index){return/*#__PURE__*/React.createElement(\"div\",{className:container.content_type===\"question\"?\"contentLittleQuestChat\":container.content_type===\"response\"?\"contentResponseChat\":\"contentLittleDestinationChat\"},Array.isArray(cardsQuest[index])&&container.content_type===\"question\"&&cardsQuest[index].map(function(card){return cardsQuestFilter[cardsQuestFilter.length-1]&&card.id===cardsQuestFilter[cardsQuestFilter.length-1][0].id?/*#__PURE__*/React.createElement(\"div\",{className:\"contentQuestChat\"},/*#__PURE__*/React.createElement(Questionchat,{text:card.content}),/*#__PURE__*/React.createElement(\"img\",{alt:\"sortouch\",src:logo,className:\"logoChat\"})):/*#__PURE__*/React.createElement(\"div\",{className:\"contentQuestChat\"},/*#__PURE__*/React.createElement(\"p\",{className:\"textQuest\"},card.content),/*#__PURE__*/React.createElement(\"img\",{alt:\"sortouch\",src:logo,className:\"logoChat\"}));}),Array.isArray(cardsRes[index])&&container.content_type===\"response\"&&cardsRes[index].map(function(card){return/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){selectResponse(card.id,index);},className:responseSelected.includes(card.id)?'containerLittleCardResChatActive':'containerLittleCardResChat'},/*#__PURE__*/React.createElement(\"p\",{id:\"container\".concat(index),className:\"textCardResChat\"},card.content));}),Array.isArray(cardsCategory[index])&&container.content_type===\"category\"&&cardsCategory[index].map(function(card){return/*#__PURE__*/React.createElement(FormContact,{categoryId:card.id,userId:props.userId,modelId:props.modelId});}));})));};export default ChatBotArea;","map":{"version":3,"sources":["/var/www/html/wp-content/plugins/sortouch/sortouch/src/chatbotArea/ChatBotArea.js"],"names":["React","useState","useEffect","Questionchat","FormContact","cross","logo","ChatBotArea","props","containers","setContainers","cardsQuest","setCardsQuest","cardsRes","setCardsRes","cardsCategory","setCardsCategory","responseSelect","setResponseSelect","storageContainers","setStorageContainers","responseSelected","setResponseSelected","pair","setPair","cardsQuestFilter","setCardsQuestFilter","chatActive","setChatActive","textIcon","setTextIcon","printContainers","userId","setTimeout","fetch","modelId","then","res","json","length","resResult","filter","response_id","newContainer","takeCard","error","console","log","stock","i","id","method","headers","resulted","result","quest","stockFilter","stockRes","stockCategory","selectResponse","cardId","index","stockContainers","numberCard","containerIndex","stockResponseSelected","a","b","c","nbRes","card","includes","splice","window","scrollTo","document","body","scrollHeight","activeChat","Array","isArray","map","container","content_type","content"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport Questionchat from '../questionBlock/QuestionChat';\nimport FormContact from '../fromContact/FormContact';\nimport cross from './cross.png'\nimport logo from './logo.png'\nimport './ChatBotArea.css'\n\nconst ChatBotArea = (props) => {\n    const [containers, setContainers] = useState([])\n    const [cardsQuest, setCardsQuest] = useState([])\n    const [cardsRes, setCardsRes] = useState([])\n    const [cardsCategory, setCardsCategory] = useState([])\n    const [responseSelect, setResponseSelect] = useState(0)\n    const [storageContainers, setStorageContainers] = useState()\n    const [responseSelected, setResponseSelected] = useState([])\n    const [pair, setPair] = useState(false)\n    const [cardsQuestFilter, setCardsQuestFilter] = useState([])\n    const [chatActive, setChatActive] = useState(false)\n    const [textIcon, setTextIcon] = useState(true)\n\n    useEffect(() => {\n        printContainers()\n    },[userId, responseSelected])\n\n    useEffect(() => {\n        setTimeout(() => {\n            setTextIcon(false)\n        }, 4000)\n    })\n\n    const printContainers = async () => {\n        try{\n            fetch(`http://192.168.43.193:8000/api/container/findAll/${props.userId}/${responseSelect}/${props.modelId}`)\n            .then(res => res.json())\n            .then(res => {\n                if(res.length){\n                    if(storageContainers){\n                        let resResult = res.filter(res => res.response_id != null)\n                        let newContainer = [...storageContainers, ...resResult]\n                        setContainers(newContainer)\n                        takeCard(newContainer)\n                    } else {\n                        setContainers(res)\n                        takeCard(res)\n                    }\n                }\n            })\n            \n            \n        } catch(error) {\n            console.log(error)\n        }\n        setStorageContainers(containers)\n    }\n\n    const takeCard = async (res) => {\n        let stock = []\n        for(let i = 0; i < res.length + 3; i++){\n            if(res[i]){\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardQuestion/${res[i].id}/${props.userId}/${props.modelId}`, {\n                    method: 'GET',\n                    headers: {\n                    'Content-Type' :'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stock = [...stock, result]\n            }\n        }\n        if(stock.length){\n\n        setCardsQuest(stock)\n        const stockFilter = await stock.filter(quest => quest[0])\n        setCardsQuestFilter(stockFilter)\n\n        }\n\n\n        let stockRes = []\n        for(let i = 0; i < res.length + 3; i++){\n            if(res[i]){\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardResponse/${res[i].id}/${props.userId}/${props.modelId}`, {\n                    method: 'GET',\n                    headers: {\n                    'Content-Type' :'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stockRes = [...stockRes, result]\n            }\n        }\n        setCardsRes(stockRes)\n        let stockCategory = []\n        for(let i = 0; i < res.length + 3; i++){\n            if(typeof res[i] === 'object'){\n                let resulted = await fetch(`http://192.168.43.193:8000/api/relation/findCardCategory/${res[i].id}/${props.userId}/${props.modelId}`, {\n                    method: 'GET',\n                    headers: {\n                    'Content-Type' :'application/json'\n                    }\n                })\n                const result = await resulted.json()\n                stockCategory = [...stockCategory, result]\n            }\n        }\n        setCardsCategory(stockCategory)\n    }\n\n    const selectResponse = async function (cardId, index) {\n        setPair(!pair)\n        const stockContainers = containers\n        const numberCard = cardId\n        const containerIndex = index + 1\n        setResponseSelect(numberCard)\n\n        \n\n        responseSelected.length = cardId\n        stockContainers.length = containerIndex\n\n        \n        let stockResponseSelected = ([...responseSelected, numberCard])\n\n            for(let a = 0; a < cardsRes.length; a++){\n                if(cardsRes[a].length){\n                    for(let b = 0; b < cardsRes[a].length; b++){\n                            for(let c = 0; c < stockResponseSelected.length; c++){\n                                const nbRes = cardsRes[a].filter(card => stockResponseSelected.includes(card.id))\n                                if(nbRes.length > 1){\n                                    for(let i = 0; i < stockResponseSelected.length; i++){\n                                        for(let a = 0; a < nbRes.length - 1; a++){\n                                            if(nbRes[a].id === (stockResponseSelected[i])){\n                                                stockResponseSelected.splice(i, 1)\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n        setResponseSelected(stockResponseSelected)\n\n        setStorageContainers(stockContainers)\n\n        if(stockContainers){\n            printContainers()\n        }\n\n        setTimeout(() => {\n            window.scrollTo(0,document.body.scrollHeight);\n        }, 700)\n    }\n\n\n    const activeChat = () => {\n        setChatActive(true)\n    }\n    \n\n    \n\n    return(\n        <div className={!chatActive ? \"containerIconChat\" : \"containerChatbot\"}>\n            {chatActive &&\n                <div className=\"headChatbot\">\n                    <img onClick={() => {setChatActive(!chatActive)}} alt=\"close sortouch\" src={cross} className=\"crossChatbot\"/>\n                    <a target=\"__blank\" href=\"https://sortouch.com\" className=\"sortouch\">Sortouch</a>\n                </div>}\n            <div className={chatActive ? \"contentChatbot\" : \"contentIcon\"}>\n            {!chatActive ?\n            <div className=\"contentIcon\">\n                {textIcon &&\n                <div className=\"contentTextIconChat\">\n                    <p onClick={activeChat} className=\"textIconCard\"><Questionchat text={\"Prenez contact avec moi !\"}/></p>\n                </div>}\n                <img alt=\"icon chat\" onClick={activeChat} src={logo} className=\"iconChat\"/>\n            </div>\n            :\n            Array.isArray(containers) &&\n            containers.map((container, index) => {\n                return(\n                    <div className={container.content_type === \"question\" ? \"contentLittleQuestChat\" : container.content_type === \"response\" ? \"contentResponseChat\" : \"contentLittleDestinationChat\"}>\n                            {Array.isArray(cardsQuest[index]) && container.content_type === \"question\" &&\n                                cardsQuest[index].map(card => {\n                                    return(\n                                        cardsQuestFilter[cardsQuestFilter.length - 1] && card.id === cardsQuestFilter[cardsQuestFilter.length - 1][0].id ?\n                                        <div className=\"contentQuestChat\">\n                                            <Questionchat text={card.content}/>\n                                            <img alt=\"sortouch\" src={logo} className=\"logoChat\"/>\n                                        </div>\n                                        :\n                                        <div className=\"contentQuestChat\">\n                                            <p className=\"textQuest\">{card.content}</p>\n                                            <img alt=\"sortouch\" src={logo} className=\"logoChat\"/>\n                                        </div>\n                                    )\n                                })}\n                            {Array.isArray(cardsRes[index]) && container.content_type === \"response\" &&\n                                cardsRes[index].map(card => {\n                                    return(\n                                        <div onClick={() => {selectResponse(card.id, index)}}   className={responseSelected.includes(card.id) ? 'containerLittleCardResChatActive' : 'containerLittleCardResChat'}>\n                                            <p id={`container${index}`} className=\"textCardResChat\">{card.content}</p>\n                                        </div>)\n                                        })\n                                    }\n                            {Array.isArray(cardsCategory[index]) && container.content_type === \"category\" &&\n                                cardsCategory[index].map(card => {\n                                    return(\n                                        <FormContact categoryId={card.id} userId={props.userId} modelId={props.modelId} />\n                                    )\n                                })}\n                    </div>\n                )\n            })}\n            </div>\n        </div>\n    )\n}\n\nexport default ChatBotArea"]},"metadata":{},"sourceType":"module"}